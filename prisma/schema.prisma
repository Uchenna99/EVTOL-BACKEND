// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum role {
  USER
  ADMIN
}

enum EvtolModel {
  Lightweight
  Middleweight
  Cruiserweight
  Heavyweight
}

enum EvtolState {
  IDLE
  LOADING
  DELIVERING
  RETURNING
  MAINTENANCE
  OFFLINE
}

enum Regions {
  Rumuola
  Rumuigbo
  Rumuokwuta
  Rumuokoro
  Rumudara
  Rumubiakani
  Rumuodumaya
  Rumuogba
}

enum Status {
  PENDING
  IN_TRANSIT
  DELIVERED
  CANCELLED
}

enum PaymentStatus {
  PENDING
  SUCCESSFUL
  FAILED
}

enum Category {
  Emergency
  General
  Laboratory
  HospitalSupplies
  ColdChain
}

model User {
  id            String          @id @unique @default(cuid())
  googleId      String?
  firstName     String
  lastName      String
  age           String
  email         String          @unique
  phoneNumber   String
  occupation    String?
  image         String?
  password      String
  role          role            @default(USER)
  orderHistory  DeliveryOrder[]
  emailVerified Boolean         @default(false)
  otp           String?
  otpExpiry     DateTime?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
}

model Evtol {
  id              Int             @id @unique @default(autoincrement())
  serialNumber    String          @unique
  model           EvtolModel
  maxWeight       Int
  image           String
  batteryCapacity Int             @default(100)
  state           EvtolState      @default(IDLE)
  Orders          DeliveryOrder[]
}

model MedicalSupply {
  id          Int      @id @unique @default(autoincrement())
  name        String
  description String
  weight      Int
  image       String
  price       Int
  category    Category @default(General)
}

model OrderItem {
  id          Int           @id @default(autoincrement())
  order       DeliveryOrder @relation(fields: [orderId], references: [id])
  orderId     String
  supplyId    Int
  quantity    Int           @default(1)
  totalWeight Int
  price  Int
}

model DeliveryOrder {
  id          String        @id @unique @default(cuid())
  evtol       Evtol?        @relation(fields: [evtolId], references: [id])
  evtolId     Int?
  userId      String
  orderItem   OrderItem[]
  reference   String?       @unique
  status      PaymentStatus @default(PENDING)
  destination String
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  user        User          @relation(fields: [userId], references: [id])
}

// model Load {
//   id            String      @id @unique @default(cuid())
//   item          Medications @relation(fields: [medicationsId], references: [id])
//   medicationsId Int
//   quantity      Int
//   Order         Order?      @relation(fields: [orderId], references: [id])
//   orderId       String?
// }

// model Order {
//   id        String   @id @unique @default(cuid())
//   loads     Load[]
//   evtol     Evtol?   @relation(fields: [evtolId], references: [id])
//   evtolId   Int?
//   userId    String
//   reference String?  @unique
//   status    Status   @default(PENDING)
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
// }

// model Medications {
//   id     Int    @id @unique @default(autoincrement())
//   name   String
//   weight Int
//   code   String @unique
//   image  String
//   price  Int
//   group  Category @default(General)
//   Load   Load[]
// }
